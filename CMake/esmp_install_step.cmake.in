
include(@cdat_CMAKE_BINARY_DIR@/cdat_common_environment.cmake)

file(GLOB_RECURSE esmp_esmfmkfile "@cdat_EXTERNALS@/lib/libO/*.mk")
set(ENV{ESMFMKFILE} ${esmp_esmfmkfile})
foreach( item ${esmp_esmfmkfile})
  message("item " ${item})
endforeach( item ${esmp_esmfmkfile})

execute_process(
  COMMAND @PYTHON_EXECUTABLE@ generateESMP_Config.py
  WORKING_DIRECTORY ""
  OUTPUT_VARIABLE CDAT_OUT
  ERROR_VARIABLE CDAT_ERR
  RESULT_VARIABLE res)

file(INSTALL @esmp_source@ DESTINATION @PYTHONPATH@)

if(NOT ${res} EQUAL 0)
  message("Install Errors detected: \n${CDAT_OUT}\n${CDAT_ERR}")
  message(FATAL_ERROR "Error in Install")
endif()
message("Install succeeded.")
